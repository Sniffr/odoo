<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Professional Appointment Booking Page -->
    <template id="appointment_booking_page" name="Book Appointment">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure oe_empty">
                <!-- Hero Section -->
                <div class="hero-section" style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 40px 0; margin-bottom: 30px;">
                    <div class="container">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h1 class="display-5 font-weight-bold text-dark mb-2">
                                    <t t-esc="request.env.company.name or 'Professional Services'"/>
                                </h1>
                                <p class="text-muted mb-0">Book your appointment with our professional team</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="container">
                    <!-- Branch Selection (Top) -->
                    <div class="branch-selection mb-5">
                        <div class="card shadow border-0" style="border-radius: 18px; overflow: hidden;">
                            <div class="card-header bg-gradient-primary text-white p-4" style="background: linear-gradient(135deg, #ff69b4, #ff8da1); border: none;">
                                <h4 class="font-weight-bold mb-0">Select a Branch</h4>
                                <p class="mb-0 opacity-75">Choose where you'd like to book your appointment</p>
                            </div>

                            <div class="card-body p-4">
                                <div class="branch-selection-container">
                                    <div class="row">
                                        <t t-if="branches">
                                            <t t-foreach="branches" t-as="branch">
                                                <div class="col-md-6 mb-3">
                                                    <div class="branch-card" style="cursor: pointer; height: 100%;" t-att-onclick="'selectBranch(this, \'' + str(branch.id) + '\')'">
                                                        <div class="card h-100" style="border-radius: 12px; border: 2px solid transparent; box-shadow: 0 3px 15px rgba(0,0,0,0.05); transition: all 0.3s ease;">
                                                            <div class="card-body p-4">
                                                                <div class="d-flex flex-column h-100">
                                                                    <div>
                                                                        <div class="d-flex align-items-center mb-3">
                                                                            <div class="branch-icon rounded-circle bg-light d-flex align-items-center justify-content-center mr-3" style="width: 50px; height: 50px; min-width: 50px;">
                                                                                <i class="fa fa-building text-primary" style="font-size: 20px;"></i>
                                                                            </div>
                                                                            <h5 class="font-weight-bold mb-0"><t t-esc="branch.name"/></h5>
                                                                        </div>

                                                                        <div class="branch-details ml-2 pl-4" style="border-left: 2px solid #f0f0f0;">
                                                                            <t t-if="branch.street">
                                                                                <p class="text-muted mb-2">
                                                                                    <i class="fa fa-map-marker mr-2"></i>
                                                                                    <t t-esc="branch.street"/>
                                                                                </p>
                                                                            </t>
                                                                            <t t-if="branch.phone">
                                                                                <p class="text-muted mb-2">
                                                                                    <i class="fa fa-phone mr-2"></i>
                                                                                    <t t-esc="branch.phone"/>
                                                                                </p>
                                                                            </t>
                                                                            <p class="text-muted mb-0">
                                                                                <i class="fa fa-clock-o mr-2"></i>
                                                                                Open today: 9:00 AM - 6:00 PM
                                                                            </p>
                                                                        </div>
                                                                    </div>
                                                                    <div class="mt-auto text-right">
                                                                        <span class="badge badge-light px-3 py-2" style="border-radius: 50px;">
                                                                            <i class="fa fa-check-circle mr-1"></i>
                                                                            Select Branch
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </t>
                                        <t t-else="">
                                            <div class="col-12 text-center py-4">
                                                <i class="fa fa-building fa-2x text-muted mb-2"></i>
                                                <p class="text-muted small">No branches available</p>
                                            </div>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <!-- Staff Selection Grid (Full Width) -->
                        <div class="col-lg-12 mb-4">
                            <div class="card shadow-sm border-0 appointment-card" style="border-radius: 15px;">
                                <div class="card-body p-4">
                                    <h5 class="font-weight-bold mb-4">Select Your Specialist</h5>

                                    <div class="staff-grid">
                                        <div class="row">
                                            <t t-if="staff_members">
                                                <t t-foreach="staff_members" t-as="staff">
                                                    <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                                                        <div class="staff-card appointment-card" style="cursor: pointer;" t-att-onclick="'selectStaff(this, \'' + str(staff.id) + '\')'">
                                                            <div class="card border-0" style="border-radius: 12px; transition: all 0.3s ease;">
                                                                <div class="card-body p-3">
                                                                    <div class="text-center mb-3">
                                                                        <t t-if="staff.image">
                                                                            <img t-att-src="'/web/image/custom.staff.member/%s/image/120x120' % staff.id"
                                                                                class="rounded-circle mx-auto"
                                                                                style="width: 85px; height: 85px; object-fit: cover;"
                                                                                alt="Staff Photo"/>
                                                                        </t>
                                                                        <t t-else="">
                                                                            <div class="rounded-circle bg-primary d-flex align-items-center justify-content-center mx-auto"
                                                                                style="width: 85px; height: 85px;">
                                                                                <i class="fa fa-user text-white fa-2x"></i>
                                                                            </div>
                                                                        </t>
                                                                    </div>
                                                                    <div class="text-center">
                                                                        <h6 class="font-weight-bold mb-1"><t t-esc="staff.name"/></h6>
                                                                        <t t-if="staff.specialization">
                                                                            <p class="text-muted small mb-1"><t t-esc="staff.specialization"/></p>
                                                                        </t>
                                                                        <div class="rating">
                                                                            <t t-foreach="range(5)" t-as="star">
                                                                                <i class="fa fa-star text-warning"></i>
                                                                            </t>
                                                                            <span class="text-muted small ml-1">5.0</span>
                                                                        </div>
                                                                        <div class="selection-indicator mt-2" style="display: none;">
                                                                            <i class="fa fa-check-circle text-success fa-lg"></i>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </t>
                                            </t>
                                            <t t-else="">
                                                <div class="col-12 text-center py-4">
                                                    <i class="fa fa-users fa-3x text-muted mb-3"></i>
                                                    <h6 class="text-muted">No Staff Available</h6>
                                                    <p class="text-muted small">Please contact us directly for appointments.</p>
                                                </div>
                                            </t>
                                        </div>
                                    </div>

                                    <!-- Location Details Section (Moved Below Specialists) -->
                                    <div class="location-details mt-5">
                                        <h5 class="font-weight-bold mb-4">Location Details</h5>
                                        <div class="row">
                                            <!-- Map Placeholder -->
                                            <div class="col-md-6 mb-4">
                                                <div class="map-placeholder" style="height: 200px; background: #f9f9f9; border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                                                    <div class="text-center">
                                                        <i class="fa fa-map-marker fa-3x text-muted mb-2"></i>
                                                        <p class="text-muted mb-0">Interactive Map</p>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-md-6">
                                                <div class="row">
                                                    <!-- Business Hours -->
                                                    <div class="col-md-12 mb-4">
                                                        <div class="business-hours">
                                                            <h6 class="font-weight-bold mb-3">Business Hours</h6>
                                                            <div class="hours-list">
                                                                <div class="d-flex justify-content-between mb-2">
                                                                    <span>Monday - Friday</span>
                                                                    <span class="text-muted">9:00 AM - 6:00 PM</span>
                                                                </div>
                                                                <div class="d-flex justify-content-between mb-2">
                                                                    <span>Saturday</span>
                                                                    <span class="text-muted">9:00 AM - 4:00 PM</span>
                                                                </div>
                                                                <div class="d-flex justify-content-between">
                                                                    <span>Sunday</span>
                                                                    <span class="text-muted">Closed</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Contact Info -->
                                            <div class="col-md-12">
                                                <div class="contact-info">
                                                    <h6 class="font-weight-bold mb-3">Contact Information</h6>
                                                    <div class="row">
                                                        <div class="col-md-4 mb-3">
                                                            <div class="contact-item">
                                                                <i class="fa fa-phone mr-2 text-primary"></i>
                                                                <span>(555) 123-4567</span>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4 mb-3">
                                                            <div class="contact-item">
                                                                <i class="fa fa-envelope mr-2 text-primary"></i>
                                                                <span>info@salon.com</span>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-4 mb-3">
                                                            <div class="contact-item">
                                                                <i class="fa fa-map-marker mr-2 text-primary"></i>
                                                                <span>123 Beauty Street, City</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Continue Button -->
                                    <div class="text-center mt-5">
                                        <button class="btn btn-lg w-50" style="background: #ff69b4; color: white; border: none; padding: 15px; border-radius: 25px; font-weight: 600;" onclick="proceedToServices()">
                                            Continue to Services
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Selection JavaScript -->
                <script>
                    let selectedStaff = null;
                    let selectedBranch = null;

                    function selectStaff(element, staffId) {
                        // Remove previous selection
                        document.querySelectorAll('.staff-card .card').forEach(card => {
                            card.style.borderColor = '';
                            card.style.background = '';
                            card.style.boxShadow = '0 4px 12px rgba(0,0,0,0.08)';
                            card.style.transform = '';
                        });

                        // Highlight selected staff with enhanced styling
                        const card = element.querySelector('.card');
                        card.style.borderColor = '#ff69b4';
                        card.style.borderWidth = '3px';
                        card.style.background = '#fff0f7';
                        card.style.boxShadow = '0 8px 20px rgba(255,105,180,0.3)';
                        card.style.transform = 'translateY(-5px)';

                        selectedStaff = staffId;
                    }

                    function selectBranch(element, branchId) {
                        // Remove previous selection
                        document.querySelectorAll('.branch-card .card').forEach(card => {
                            card.style.borderColor = 'transparent';
                            card.style.boxShadow = '0 3px 10px rgba(0,0,0,0.08)';
                            card.style.background = '';

                            // Reset badge to default state
                            const badge = card.querySelector('.badge');
                            if (badge) {
                                badge.style.background = '';
                                badge.style.color = '';
                                badge.style.borderColor = '#e9ecef';
                                badge.innerHTML = '<i class="fa fa-map-pin mr-1"></i> Select Branch';
                            }
                        });
                        
                        // Highlight selected branch with border and styling
                        const card = element.querySelector('.card');
                        card.style.borderColor = '#ff69b4';
                        card.style.boxShadow = '0 5px 15px rgba(255,105,180,0.2)';
                        card.style.background = '#fff5f8';
                        card.style.transform = 'translateY(-5px)';

                        // Update selection badge to green "Selected Branch" with checkmark
                        const badge = card.querySelector('.badge');
                        if (badge) {
                            badge.style.background = '#28a745';
                            badge.style.color = 'white';
                            badge.style.borderColor = '#28a745';
                            badge.innerHTML = '<i class="fa fa-check-circle mr-1"></i> Selected Branch';
                        }

                        selectedBranch = branchId;
                    }

                    function proceedToServices() {
                        if (!selectedStaff) {
                            alert('Please select a staff member before continuing.');
                            return;
                        }

                        const params = new URLSearchParams();
                        params.append('staff_id', selectedStaff);
                        if (selectedBranch) {
                            params.append('branch_id', selectedBranch);
                        }

                        window.location.href = `/appointments/services?${params.toString()}`;
                    }
                </script>
            </div>
        </t>
    </template>

    <!-- Professional Service Selection Page -->
    <template id="service_selection_page" name="Select Services">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure oe_empty">
                <!-- Hero Section -->
                <div class="hero-section" style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 40px 0; margin-bottom: 30px;">
                    <div class="container">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h1 class="display-5 font-weight-bold text-dark mb-2">
                                    <t t-esc="request.env.company.name or 'Professional Services'"/>
                                    <t t-if="selected_branch"> - <t t-esc="selected_branch.name"/></t>
                                </h1>
                                <p class="text-muted mb-0">Select your preferred services</p>
                            </div>
                            <div class="col-md-4 text-right">
                                <button class="btn" style="background: #ff69b4; color: white; border: none; padding: 10px 25px; border-radius: 20px; font-weight: 600;">
                                    Change branch
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="container">
                    <!-- Team Member Selection (Top) -->
                    <div class="team-selection mb-5">
                        <div class="card shadow-sm border-0" style="border-radius: 15px;">
                            <div class="card-body p-4">
                                <h5 class="font-weight-bold mb-4">Select Team Member</h5>
                                
                                <div class="row">
                                    <!-- Any Team Member Option -->
                                    <div class="col-lg-2 col-md-3 col-sm-4 col-6 mb-3">
                                        <div class="team-card text-center" style="cursor: pointer;" onclick="selectTeamMember(this, 'any')">
                                            <div class="card border-0" style="border-radius: 12px; transition: all 0.3s ease;">
                                                <div class="card-body p-3">
                                                    <div class="team-avatar mb-2">
                                                        <div class="rounded-circle bg-secondary d-flex align-items-center justify-content-center mx-auto" 
                                                             style="width: 60px; height: 60px;">
                                                            <i class="fa fa-users text-white"></i>
                                                        </div>
                                                    </div>
                                                    <h6 class="font-weight-bold mb-1">Any</h6>
                                                    <p class="text-muted small mb-0">Available</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Individual Team Members -->
                                    <t t-if="staff_members">
                                        <t t-foreach="staff_members" t-as="staff">
                                            <div class="col-lg-2 col-md-3 col-sm-4 col-6 mb-3">
                                                <div class="team-card text-center" style="cursor: pointer;" t-att-onclick="'selectTeamMember(this, ' + str(staff.id) + ')'">
                                                    <div class="card border-0" style="border-radius: 12px; transition: all 0.3s ease;">
                                                        <div class="card-body p-3">
                                                            <div class="team-avatar mb-2">
                                                                <t t-if="staff.image">
                                                                    <img t-att-src="'/web/image/custom.staff.member/%s/image/80x80' % staff.id" 
                                                                         class="rounded-circle mx-auto d-block" 
                                                                         style="width: 60px; height: 60px; object-fit: cover;" 
                                                                         alt="Staff Photo"/>
                                                                </t>
                                                                <t t-else="">
                                                                    <div class="rounded-circle bg-primary d-flex align-items-center justify-content-center mx-auto" 
                                                                         style="width: 60px; height: 60px;">
                                                                        <i class="fa fa-user text-white"></i>
                                                                    </div>
                                                                </t>
                                                            </div>
                                                            <h6 class="font-weight-bold mb-1"><t t-esc="staff.name"/></h6>
                                                            <t t-if="staff.specialization">
                                                                <p class="text-muted small mb-0"><t t-esc="staff.specialization"/></p>
                                                            </t>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </t>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Service Selection -->
                    <div class="service-selection">
                        <div class="row">
                            <div class="col-12">
                                <!-- Search Bar -->
                                <div class="search-section mb-4">
                                    <div class="card shadow-sm border-0" style="border-radius: 15px;">
                                        <div class="card-body p-4">
                                            <div class="row align-items-center">
                                                <div class="col-md-8">
                                                    <div class="search-input-group">
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text bg-white border-right-0" style="border-radius: 20px 0 0 20px;">
                                                                    <i class="fa fa-search text-muted"></i>
                                                                </span>
                                                            </div>
                                                            <input type="text" class="form-control border-left-0" placeholder="Search for services..." 
                                                                   style="border-radius: 0 20px 20px 0; padding: 12px;" id="service-search"/>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-4 text-right">
                                                    <div class="filter-buttons">
                                                        <button class="btn btn-outline-secondary mr-2" style="border-radius: 20px;">
                                                            <i class="fa fa-filter mr-1"></i> Filter
                                                        </button>
                                                        <button class="btn btn-outline-secondary" style="border-radius: 20px;">
                                                            <i class="fa fa-sort mr-1"></i> Sort
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Services by Category -->
                                <t t-if="service_categories and services">
                                    <t t-foreach="service_categories" t-as="category">
                                        <t t-if="services.filtered(lambda s: s.category_id.id == category.id)">
                                            <div class="category-section mb-5">
                                                <!-- Category Header -->
                                                <div class="category-header mb-3 p-3" style="background: #f8f9fa; border-radius: 10px; border-left: 4px solid #ff69b4;">
                                                    <h5 class="font-weight-bold mb-0">
                                                        <t t-if="category.image">
                                                            <img t-att-src="'/web/image/service.category/%s/image/30x30' % category.id" class="rounded mr-2" style="width: 24px; height: 24px; object-fit: cover;" alt="Category Image"/>
                                                        </t>
                                                        <t t-esc="category.name"/>
                                                    </h5>
                                                </div>
                                                
                                                <!-- Services in Category -->
                                                <div class="services-list">
                                                    <t t-foreach="services.filtered(lambda s: s.category_id.id == category.id)" t-as="service">
                                                        <div class="service-item mb-3 p-4" style="background: white; border: 1px solid #e9ecef; border-radius: 15px; cursor: pointer; transition: all 0.3s ease;" t-att-onclick="'selectService(this, ' + str(service.id) + ')'">
                                                            <div class="row align-items-center">
                                                                <div class="col-md-8">
                                                                    <div class="d-flex align-items-start">
                                                                        <t t-if="service.image">
                                                                            <img t-att-src="'/web/image/company.service/%s/image/80x80' % service.id" 
                                                                                 class="rounded mr-3" 
                                                                                 style="width: 60px; height: 60px; object-fit: cover;" 
                                                                                 alt="Service Image"/>
                                                                        </t>
                                                                        <div class="flex-grow-1">
                                                                            <h6 class="font-weight-bold mb-1"><t t-esc="service.name"/></h6>
                                                                            <t t-if="service.description">
                                                                                <p class="text-muted mb-2 small">
                                                                                    <t t-esc="service.description[:100]"/>
                                                                                    <t t-if="len(service.description) > 100">...</t>
                                                                                </p>
                                                                            </t>
                                                                            <div class="service-meta">
                                                                                <span class="badge badge-light mr-2">
                                                                                    <i class="fa fa-clock-o mr-1"></i>
                                                                                    <t t-esc="service.duration"/>h
                                                                                </span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4 text-right">
                                                                    <div class="service-price">
                                                                        <h5 class="font-weight-bold text-primary mb-1">
                                                                            from <t t-esc="service.currency_id.symbol"/><t t-esc="service.price"/>
                                                                        </h5>
                                                                        <div class="service-selection">
                                                                            <input type="radio" name="selected_service" t-att-value="service.id" style="transform: scale(1.5);"/>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </t>
                                                </div>
                                            </div>
                                        </t>
                                    </t>
                                </t>
                                <t t-else="">
                                    <div class="text-center py-5">
                                        <i class="fa fa-list fa-3x text-muted mb-3"></i>
                                        <h5 class="text-muted">No Services Available</h5>
                                        <p class="text-muted">Please contact us directly for service information.</p>
                                    </div>
                                </t>
                            </div>
                        </div>
                    </div>

                    <!-- Continue Button -->
                    <div class="text-center mt-4 mb-5">
                        <button class="btn btn-lg" 
                                style="background: #ff69b4; color: white; border: none; padding: 15px 40px; border-radius: 25px; font-weight: 600;"
                                onclick="proceedToBooking()">
                            Continue to Booking
                        </button>
                    </div>
                </div>

                <!-- JavaScript for Service Selection -->
                <script>
                    let selectedTeamMember = 'any';
                    let defaultStaffId = '1';
                    let selectedService = null;

                    function selectTeamMember(element, memberId) {
                        document.querySelectorAll('.team-card .card').forEach(card => {
                            card.style.borderColor = '';
                            card.style.background = '';
                        });
                        
                        const card = element.querySelector('.card');
                        card.style.borderColor = '#ff69b4';
                        card.style.background = '#fff5f8';
                        
                        selectedTeamMember = memberId;
                    }

                    function selectService(element, serviceId) {
                        document.querySelectorAll('.service-item').forEach(item => {
                            item.style.borderColor = '#e9ecef';
                            item.style.background = 'white';
                            const radio = item.querySelector('input[type="radio"]');
                            if (radio) radio.checked = false;
                        });
                        
                        element.style.borderColor = '#ff69b4';
                        element.style.background = '#fff5f8';
                        
                        const radio = element.querySelector('input[type="radio"]');
                        if (radio) radio.checked = true;
                        
                        selectedService = serviceId;
                    }

                    function searchServices(query) {
                        const serviceItems = document.querySelectorAll('.service-item');
                        serviceItems.forEach(item => {
                            const serviceName = item.querySelector('h6').textContent.toLowerCase();
                            const serviceDesc = item.querySelector('p').textContent.toLowerCase();
                            const searchText = (serviceName + ' ' + serviceDesc).toLowerCase();
                            
                            if (searchText.includes(query.toLowerCase())) {
                                item.parentElement.style.display = 'block';
                            } else {
                                item.parentElement.style.display = 'none';
                            }
                        });
                    }

                    function proceedToBooking() {
                        if (!selectedService) {
                            alert('Please select a service before continuing.');
                            return;
                        }
                        
                        const staffParam = selectedTeamMember === 'any' ? defaultStaffId : selectedTeamMember;
                        window.location.href = '/appointments/book?service_id=' + selectedService + '&amp;staff_id=' + staffParam;
                    }

                    document.addEventListener('DOMContentLoaded', function() {
                        const urlParams = new URLSearchParams(window.location.search);
                        const staffId = urlParams.get('staff_id');
                        if (staffId) {
                            selectedTeamMember = staffId;
                            defaultStaffId = staffId;
                        }
                    });
                </script>
            </div>
        </t>
    </template>

    <!-- Professional Booking Form Page -->
    <template id="booking_form_page" name="Book Appointment">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure oe_empty">
                <!-- Hero Section -->
                <div class="hero-section" style="background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 40px 0; margin-bottom: 30px;">
                    <div class="container">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h1 class="display-5 font-weight-bold text-dark mb-2">Book Your Appointment</h1>
                                <p class="text-muted mb-0">Select your preferred time slot</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="container">
                    <div class="row">
                        <!-- Left Panel - Time Slots -->
                        <div class="col-lg-8 mb-4">
                            <div class="card shadow-sm border-0" style="border-radius: 15px;">
                                <div class="card-body p-4">
                                    <h5 class="font-weight-bold mb-4">Available Time Slots</h5>
                                    
                                    <!-- Date Navigation -->
                                    <div class="date-navigation mb-4">
                                        <div class="row">
                                            <div class="col-12">
                                                <div class="d-flex align-items-center justify-content-between mb-3">
                                                    <button class="btn btn-outline-secondary" onclick="previousWeek()">
                                                        <i class="fa fa-chevron-left"></i> Previous
                                                    </button>
                                                    <h6 class="mb-0" id="current-week">This Week</h6>
                                                    <button class="btn btn-outline-secondary" onclick="nextWeek()">
                                                        Next <i class="fa fa-chevron-right"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Time Slots Grid -->
                                    <div class="time-slots-container">
                                        <t t-foreach="available_slots.items()" t-as="date_slots">
                                            <div class="date-section mb-4">
                                                <h6 class="font-weight-bold mb-3 text-primary">
                                                    <t t-esc="date_slots[0]"/>
                                                </h6>
                                                <div class="row">
                                                    <t t-foreach="date_slots[1]" t-as="slot">
                                                        <div class="col-md-3 col-sm-4 col-6 mb-2">
                                                            <button class="btn btn-outline-primary time-slot-btn w-100" 
                                                                    style="border-radius: 20px; padding: 10px; transition: all 0.3s ease;"
                                                                    t-att-onclick="'selectTimeSlot(this, \'' + slot['datetime'] + '\')'">
                                                                <t t-esc="slot['time']"/>
                                                            </button>
                                                        </div>
                                                    </t>
                                                </div>
                                            </div>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Right Panel - Booking Summary & Customer Info -->
                        <div class="col-lg-4 mb-4">
                            <div class="card shadow-sm border-0" style="border-radius: 15px;">
                                <div class="card-body p-4">
                                    <!-- Booking Summary -->
                                    <h5 class="font-weight-bold mb-4">Booking Summary</h5>
                                    
                                    <div class="booking-summary mb-4">
                                        <div class="summary-item mb-3 p-3" style="background: #f8f9fa; border-radius: 10px;">
                                            <div class="d-flex align-items-center">
                                                <t t-if="service.image">
                                                    <img t-att-src="'/web/image/company.service/%s/image/60x60' % service.id" 
                                                         class="rounded mr-3" 
                                                         style="width: 50px; height: 50px; object-fit: cover;" 
                                                         alt="Service Image"/>
                                                </t>
                                                <div class="flex-grow-1">
                                                    <h6 class="font-weight-bold mb-1"><t t-esc="service.name"/></h6>
                                                    <p class="text-muted small mb-0">
                                                        <i class="fa fa-clock mr-1"></i><t t-esc="service.duration"/>h
                                                        | <t t-esc="service.currency_id.symbol"/><t t-esc="service.price"/>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="summary-item mb-3 p-3" style="background: #f8f9fa; border-radius: 10px;">
                                            <div class="d-flex align-items-center">
                                                <t t-if="staff.image">
                                                    <img t-att-src="'/web/image/custom.staff.member/%s/image/60x60' % staff.id" 
                                                         class="rounded-circle mr-3" 
                                                         style="width: 50px; height: 50px; object-fit: cover;" 
                                                         alt="Staff Photo"/>
                                                </t>
                                                <t t-else="">
                                                    <div class="rounded-circle bg-primary d-flex align-items-center justify-content-center mr-3" 
                                                         style="width: 50px; height: 50px;">
                                                        <i class="fa fa-user text-white"></i>
                                                    </div>
                                                </t>
                                                <div class="flex-grow-1">
                                                    <h6 class="font-weight-bold mb-1"><t t-esc="staff.name"/></h6>
                                                    <t t-if="staff.specialization">
                                                        <p class="text-muted small mb-0"><t t-esc="staff.specialization"/></p>
                                                    </t>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="selected-time-display mb-3 p-3" style="background: #fff5f8; border: 2px solid #ff69b4; border-radius: 10px; display: none;">
                                            <h6 class="font-weight-bold text-primary mb-1">Selected Time</h6>
                                            <p class="mb-0" id="selected-time-text">Please select a time slot</p>
                                        </div>
                                    </div>

                                    <!-- Customer Information Form -->
                                    <form id="booking-form" method="post" t-attf-action="/appointments/book?service_id={{service.id}}&amp;staff_id={{staff.id}}">
                                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                        <input type="hidden" name="service_id" t-att-value="service.id"/>
                                        <input type="hidden" name="staff_id" t-att-value="staff.id"/>
                                        <input type="hidden" name="appointment_datetime" id="appointment_datetime"/>

                                        <div class="form-group mb-3">
                                            <label class="font-weight-bold">Full Name *</label>
                                            <input type="text" class="form-control" name="customer_name" required="" style="border-radius: 10px; padding: 12px;"/>
                                        </div>

                                        <div class="form-group mb-3">
                                            <label class="font-weight-bold">Email Address *</label>
                                            <input type="email" class="form-control" name="customer_email" required="" style="border-radius: 10px; padding: 12px;"/>
                                        </div>

                                        <div class="form-group mb-3">
                                            <label class="font-weight-bold">Phone Number</label>
                                            <input type="tel" class="form-control" name="customer_phone" style="border-radius: 10px; padding: 12px;"/>
                                        </div>

                                        <div class="form-group mb-4">
                                            <label class="font-weight-bold">Special Requests</label>
                                            <textarea class="form-control" name="notes" rows="3" placeholder="Any special requests or notes..." style="border-radius: 10px; padding: 12px;"></textarea>
                                        </div>

                                        <button type="submit" class="btn btn-lg w-100" style="background: #ff69b4; color: white; border: none; padding: 15px; border-radius: 25px; font-weight: 600;" disabled="" id="book-btn">
                                            Book Appointment
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Time Slot Selection JavaScript -->
                <script>
                    let selectedDateTime = null;

                    function selectTimeSlot(button, datetime) {
                        // Remove previous selection
                        document.querySelectorAll('.time-slot-btn').forEach(btn => {
                            btn.classList.remove('btn-primary');
                            btn.classList.add('btn-outline-primary');
                        });
                        
                        // Highlight selected slot
                        button.classList.remove('btn-outline-primary');
                        button.classList.add('btn-primary');
                        
                        // Update selected time display
                        selectedDateTime = datetime;
                        document.getElementById('appointment_datetime').value = datetime;
                        
                        const timeDisplay = document.querySelector('.selected-time-display');
                        const timeText = document.getElementById('selected-time-text');
                        
                        const date = new Date(datetime);
                        const formattedTime = date.toLocaleDateString() + ' at ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                        
                        timeText.textContent = formattedTime;
                        timeDisplay.style.display = 'block';
                        
                        // Enable book button
                        document.getElementById('book-btn').disabled = false;
                    }

                    function previousWeek() {
                        // Implementation for previous week navigation
                        console.log('Previous week clicked');
                    }

                    function nextWeek() {
                        // Implementation for next week navigation
                        console.log('Next week clicked');
                    }
                </script>
            </div>
        </t>
    </template>

    <!-- Booking Success Page -->
    <template id="booking_success_page" name="Booking Confirmation">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure oe_empty">
                <div class="container py-5">
                    <div class="row justify-content-center">
                        <div class="col-md-8 text-center">
                            <div class="card shadow-sm border-0" style="border-radius: 15px;">
                                <div class="card-body p-5">
                                    <i class="fa fa-check-circle fa-5x text-success mb-4"></i>
                                    <h2 class="font-weight-bold mb-3">Booking Confirmed!</h2>
                                    <p class="text-muted mb-4">Your appointment has been successfully booked.</p>
                                    
                                    <div class="booking-details p-4" style="background: #f8f9fa; border-radius: 10px;">
                                        <h5 class="font-weight-bold mb-3">Appointment Details</h5>
                                        <p><strong>Service:</strong> <t t-esc="service.name"/></p>
                                        <p><strong>Staff:</strong> <t t-esc="staff.name"/></p>
                                        <p><strong>Date &amp; Time:</strong> <t t-esc="appointment.start"/></p>
                                        <p><strong>Duration:</strong> <t t-esc="service.duration"/> hours</p>
                                        <p><strong>Total:</strong> <t t-esc="service.currency_id.symbol"/><t t-esc="service.price"/></p>
                                    </div>
                                    
                                    <div class="mt-4">
                                        <a href="/appointments" class="btn btn-primary mr-3">Book Another</a>
                                        <a href="/" class="btn btn-outline-secondary">Back to Home</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <!-- Booking Error Page -->
    <template id="booking_error_page" name="Booking Error">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure oe_empty">
                <div class="container py-5">
                    <div class="row justify-content-center">
                        <div class="col-md-8 text-center">
                            <div class="card shadow-sm border-0" style="border-radius: 15px;">
                                <div class="card-body p-5">
                                    <i class="fa fa-exclamation-triangle fa-5x text-warning mb-4"></i>
                                    <h2 class="font-weight-bold mb-3">Booking Error</h2>
                                    <p class="text-muted mb-4">There was an issue processing your booking.</p>
                                    
                                    <div class="error-details p-4" style="background: #fff3cd; border-radius: 10px;">
                                        <p class="mb-0"><t t-esc="error"/></p>
                                    </div>
                                    
                                    <div class="mt-4">
                                        <a href="/appointments" class="btn btn-primary mr-3">Try Again</a>
                                        <a href="/" class="btn btn-outline-secondary">Back to Home</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <!-- Payment Page -->
    <template id="payment_page" name="Payment for Appointment">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure oe_empty">
                <div class="container py-5">
                    <div class="row justify-content-center">
                        <div class="col-md-8">
                            <div class="card shadow-sm border-0" style="border-radius: 15px;">
                                <div class="card-body p-5">
                                    <h2 class="font-weight-bold mb-4 text-center">Complete Your Payment</h2>
                                    
                                    <!-- Appointment Summary -->
                                    <div class="appointment-summary mb-4 p-4" style="background: #f8f9fa; border-radius: 10px;">
                                        <h5 class="font-weight-bold mb-3">Appointment Summary</h5>
                                        <p><strong>Service:</strong> <t t-esc="appointment.service_id.name"/></p>
                                        <p><strong>Staff:</strong> <t t-esc="appointment.staff_member_id.name"/></p>
                                        <p><strong>Date &amp; Time:</strong> <t t-esc="appointment.start"/></p>
                                        <p><strong>Duration:</strong> <t t-esc="appointment.service_id.duration"/> hours</p>
                                        <p class="mb-0"><strong>Total Amount:</strong> 
                                            <span class="h4 text-primary">
                                                <t t-esc="currency.symbol"/><t t-esc="amount"/>
                                            </span>
                                        </p>
                                    </div>
                                    
                                    <!-- Payment Methods -->
                                    <form method="post" t-attf-action="/appointments/payment">
                                        <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                        <input type="hidden" name="appointment_id" t-att-value="appointment.id"/>
                                        
                                        <h5 class="font-weight-bold mb-3">Select Payment Method</h5>
                                        
                                        <div class="payment-methods mb-4">
                                            <t t-foreach="acquirers" t-as="acquirer">
                                                <div class="payment-option mb-3">
                                                    <div class="card border" style="cursor: pointer;" t-attf-onclick="selectPaymentMethod(this, '#{acquirer.id}')">
                                                        <div class="card-body p-3">
                                                            <div class="d-flex align-items-center">
                                                                <input type="radio" name="acquirer_id" t-att-value="acquirer.id" class="mr-3"/>
                                                                <div class="flex-grow-1">
                                                                    <h6 class="mb-1"><t t-esc="acquirer.name"/></h6>
                                                                    <small class="text-muted">Secure payment processing</small>
                                                                </div>
                                                                <t t-if="acquirer.image">
                                                                    <img t-attf-src="/web/image/payment.provider/#{acquirer.id}/image/50x30" 
                                                                         class="ml-3" alt="Payment Method"/>
                                                                </t>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </div>
                                        
                                        <button type="submit" class="btn btn-lg w-100" 
                                                style="background: #ff69b4; color: white; border: none; padding: 15px; border-radius: 25px; font-weight: 600;"
                                                disabled="" id="pay-btn">
                                            Pay <t t-esc="currency.symbol"/><t t-esc="amount"/>
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <script>
                    function selectPaymentMethod(element, acquirerId) {
                        document.querySelectorAll('.payment-option .card').forEach(card => {
                            card.classList.remove('border-primary');
                        });
                        
                        element.classList.add('border-primary');
                        element.querySelector('input[type="radio"]').checked = true;
                        document.getElementById('pay-btn').disabled = false;
                    }
                </script>
            </div>
        </t>
    </template>

    <!-- Payment Error Page -->
    <template id="payment_error_page" name="Payment Error">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure oe_empty">
                <div class="container py-5">
                    <div class="row justify-content-center">
                        <div class="col-md-8 text-center">
                            <div class="card shadow-sm border-0" style="border-radius: 15px;">
                                <div class="card-body p-5">
                                    <i class="fa fa-exclamation-triangle fa-5x text-warning mb-4"></i>
                                    <h2 class="font-weight-bold mb-3">Payment Error</h2>
                                    <p class="text-muted mb-4">There was an issue processing your payment.</p>
                                    
                                    <div class="error-details p-4" style="background: #fff3cd; border-radius: 10px;">
                                        <p class="mb-0"><t t-esc="error"/></p>
                                    </div>
                                    
                                    <div class="mt-4">
                                        <a href="/appointments" class="btn btn-primary mr-3">Try Again</a>
                                        <a href="/" class="btn btn-outline-secondary">Back to Home</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <!-- Payment Success Page -->
    <template id="payment_success_page" name="Payment Success">
        <t t-call="website.layout">
            <div id="wrap" class="oe_structure oe_empty">
                <div class="container py-5">
                    <div class="row justify-content-center">
                        <div class="col-md-8 text-center">
                            <div class="card shadow-sm border-0" style="border-radius: 15px;">
                                <div class="card-body p-5">
                                    <i class="fa fa-check-circle fa-5x text-success mb-4"></i>
                                    <h2 class="font-weight-bold mb-3">Payment Successful!</h2>
                                    <p class="text-muted mb-4">Your appointment has been confirmed and payment processed.</p>
                                    
                                    <div class="appointment-details p-4" style="background: #d4edda; border-radius: 10px;">
                                        <h5 class="font-weight-bold mb-3">Appointment Details</h5>
                                        <p><strong>Service:</strong> <t t-esc="appointment.service_id.name"/></p>
                                        <p><strong>Staff:</strong> <t t-esc="appointment.staff_member_id.name"/></p>
                                        <p><strong>Date &amp; Time:</strong> <t t-esc="appointment.start"/></p>
                                        <p><strong>Amount Paid:</strong> <t t-esc="appointment.currency_id.symbol"/><t t-esc="appointment.paid_amount"/></p>
                                        <p class="mb-0"><strong>Reference:</strong> <t t-esc="appointment.payment_reference"/></p>
                                    </div>
                                    
                                    <div class="mt-4">
                                        <a href="/appointments" class="btn btn-primary mr-3">Book Another</a>
                                        <a href="/" class="btn btn-outline-secondary">Back to Home</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

</odoo>
